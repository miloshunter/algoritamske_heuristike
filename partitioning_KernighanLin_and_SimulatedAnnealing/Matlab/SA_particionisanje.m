% In this file, testcase for SimulatedAnnealing algorithm is written
%   For one digital circuit, weighted matrix is made
%   One Kerninghan-Lin pass is done, and swap of elements is tracked

% Initial partitioning of the circuit
P1 = [1 3 5 7 9];
P2= [2 4 6 8 10];

% Weighted unidirected graph of the circuit
A = [0 0 0 .5 0 .5 0 0 0 0;...
     0 0 0 .25 .25 0 .25 .25 0 0;...
     0 0 0 0 .5 0 0 .5 0 0;...
     0 0 0 0 .25 1 .75 .25 0 0;...
     0 0 0 0 0 0 .58 1.08 0 .33;...
     0 0 0 0 0 0 .5 0 1 0;...
     0 0 0 0 0 0 0 .58 .5 .83;...
     0 0 0 0 0 0 0 0 0 1.33;...
     0 0 0 0 0 0 0 0 0 .5;...
     0 0 0 0 0 0 0 0 0 0;...
     ];
G = (A+A') - eye(size(A,1)).*diag(A);

cut_size = @(P)sum(sum(G(P(1, :),P(2, :))'));


[minimum,fval] = anneal(P1, P2, G, cut_size);